<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('partials/head') %> <%- title %>
  </head>
  <body>
    <div class="container d-flex align-items-center vh-100 table-responsive">
      <table class="table table-striped table-bordered table-hover">
        <thead class="thead-dark">
          <tr>
            <th scope="col">#</th>
            <th scope="col">Title</th>
            <th scope="col">Tag</th>
            <th scope="col">Active</th>
            <th scope="col">Upload Date</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% results.forEach(function(result) { %>
          <tr>
            <th scope="row"><%= result.id %></th>
            <td><%= result.title %></td>
            <td><%= result.tag %></td>
            <td><%= result.active %></td>
            <td><%= result.date %></td>
            <td colspan="2">
              <a
                href="/api/image/<%= result.id %>"
                class="btn btn-success"
                role="button"
              >
                View
              </a>
              <a
                href="/api/image/<%= result.id %>/edit"
                class="btn btn-primary"
                role="button"
              >
                Edit
              </a>
              <form
                action="/api/delete/<%= result.id %>"
                name="delete-button"
                style="display: inline-block"
                onsubmit="handleDelete(event)"
              >
                <button type="submit" class="btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
    <!-- End table -->

    <%- include('partials/bootstrapjs') %>
    <script>
      // get form action and send delete
      const formUrl = document.forms.namedItem("delete-button").action;

      function handleDelete(event) {
        event.preventDefault();
        const xhr = new XMLHttpRequest();
        xhr.open("DELETE", formUrl);
        xhr.send();
      }
    </script>
  </body>
</html>
